<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Clappr Player with P2P</title>
    <!-- Clappr core -->
    <script src="https://cdn.jsdelivr.net/npm/clappr@latest/dist/clappr.min.js"></script>
    <!-- Level Selector plugin -->
    <script src="https://cdn.jsdelivr.net/npm/clappr-level-selector/dist/clappr-level-selector.min.js"></script>
    <!-- Responsive Container plugin -->
    <script src="https://cdn.jsdelivr.net/npm/clappr-responsive-container/dist/ClapprResponsiveContainer.min.js"></script>
    <!-- CDNBye P2P plugin -->
    <script src="https://cdn.jsdelivr.net/npm/clappr-p2p-media-loader/dist/clappr-p2p-media-loader.min.js"></script>

    <style>
        body {
            background: #111;
            color: #fff;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
        }
        #player {
            width: 80%;
            max-width: 800px;
            aspect-ratio: 16 / 9;
            margin-top: 20px;
        }
        h2 { font-family: sans-serif; }
    </style>
</head>
<body>

<h2>Clappr Player with P2P</h2>
<div id="player"></div>

<script>
    // Ensure plugins are loaded
    var pluginsArray = [
        Clappr.ResponsiveContainer,
        Clappr.LevelSelector,
        CDNByeClapprPlugin  // P2P plugin
    ].filter(Boolean);

    var player = new Clappr.Player({
        source: "https://cyclingstreams.live/hls/S2.m3u8",
        parentId: "#player",
        autoPlay: false,
        width: "100%",
        height: "100%",
        plugins: pluginsArray,
        levelSelectorConfig: {
            title: 'Quality',
            labels: {
                1: 'High-', // 240kbps
                0: 'Low-'   // 120kbps
            },
            labelCallback: function(playbackLevel, customLabel) {
                return customLabel + (playbackLevel.level ? playbackLevel.level.height + 'p' : '');
            }
        },
        playback: {
            hlsjsConfig: {
                p2pConfig: {
                    logLevel: 'debug',
                    live: true
                }
            }
        }
    });
</script>

</body>
</html>
