<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Today's Football Matches - Major Leagues</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body {
      font-family: Inter, system-ui, Arial;
      margin: 20px;
      background:#f1f5f9;
      color:#0f172a;
    }
    .card {
      background:white;
      padding:20px;
      border-radius:14px;
      box-shadow:0 6px 20px rgba(2,6,23,0.08);
      max-width:1200px;
      margin:20px auto;
    }
    header {
      display:flex;
      flex-wrap:wrap;
      gap:12px;
      align-items:center;
      justify-content:space-between;
      margin-bottom:12px;
    }
    h1 { font-size:22px; margin:0; }
    .controls { display:flex; gap:8px; align-items:center; }
    .btn {
      padding:8px 14px;
      border-radius:8px;
      border:1px solid #cbd5e1;
      background:#3b82f6;
      color:white;
      cursor:pointer;
      font-weight:500;
    }
    .btn:hover { background:#2563eb; }
    input[type="text"] {
      padding:8px;
      border-radius:8px;
      border:1px solid #cbd5e1;
      width:280px;
    }
    .matches { margin-top:16px; display:grid; gap:14px; }
    .match {
      display:flex;
      justify-content:space-between;
      gap:12px;
      padding:16px;
      border-radius:12px;
      border:1px solid #e2e8f0;
      align-items:center;
      background:#f8fafc;
      flex-wrap:wrap;
    }
    .time { font-size:13px; color:#475569; width:90px; flex-shrink:0; }
    .teams {
      display:flex;
      flex:1;
      align-items:center;
      justify-content:center;
      gap:12px;
    }
    .team {
      display:flex;
      align-items:center;
      gap:6px;
      min-width:160px;
    }
    .team img { width:26px; height:26px; }
    .score {
      font-weight:700;
      font-size:17px;
      margin:0 12px;
      color:#111827;
    }
    .right {
      text-align:right;
      min-width:200px;
    }
    .league {
      font-size:14px;
      font-weight:600;
      color:#334155;
      display:flex;
      align-items:center;
      justify-content:flex-end;
      gap:6px;
    }
    .league img { width:18px; height:18px; }
    .status { font-weight:600; font-size:13px; color:#1e293b; margin-top:2px; }
    .small { font-size:12px; color:#64748b; }
    .notice { margin-top:10px; font-size:13px; color:#334155; }
  </style>
</head>
<body>
  <div class="card" id="app">
    <header>
      <div>
        <h1>Today's Major League Matches</h1>
        <div class="small">Auto-detected date: <span id="dateLabel">—</span></div>
      </div>
      <div class="controls">
        <label class="small" title="Leave API key empty to use demo data">API Key:</label>
        <input id="apiKey" type="text" placeholder="Paste your x-apisports-key here" />
        <button class="btn" id="refreshBtn">Refresh</button>
      </div>
    </header>

    <div id="status" class="notice">Loading…</div>
    <div class="matches" id="matches"></div>
  </div>

  <script>
    const LIVE_BASE = 'https://v3.football.api-sports.io/fixtures';

    // ✅ Major Leagues
    const MAJOR_LEAGUES = [
      2,   // Champions League
      3,   // Europa League
      39,  // Premier League
      140, // La Liga
      135, // Serie A
      78,  // Bundesliga
      61,  // Ligue 1
      253, // MLS
      307  // Saudi Pro League
    ];

    const dateLabel = document.getElementById('dateLabel');
    const matchesEl = document.getElementById('matches');
    const statusEl = document.getElementById('status');
    const apiKeyInput = document.getElementById('apiKey');
    const refreshBtn = document.getElementById('refreshBtn');

    function todayISO() {
      const d = new Date();
      return d.toISOString().split('T')[0];
    }

    async function fetchMatches(dateStr, apiKey) {
      const url = `${LIVE_BASE}?date=${encodeURIComponent(dateStr)}`;
      const headers = { 'x-apisports-key': apiKey.trim() };
      const res = await fetch(url, { headers });
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      return res.json();
    }

    function formatLocalTime(utc) {
      const d = new Date(utc);
      return d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
    }

    function renderMatches(data) {
      matchesEl.innerHTML = '';
      if (!data.response || data.response.length === 0) {
        statusEl.textContent = 'No matches found today.';
        return;
      }

      const majorMatches = data.response.filter(item =>
        MAJOR_LEAGUES.includes(item.league?.id)
      );

      if (majorMatches.length === 0) {
        statusEl.textContent = 'No major league matches today.';
        return;
      }

      statusEl.textContent = `Found ${majorMatches.length} major league match(es).`;

      majorMatches.forEach(item => {
        const f = item.fixture;
        const home = item.teams.home;
        const away = item.teams.away;
        const g = item.goals;
        const league = item.league;

        const div = document.createElement('div');
        div.className = 'match';
        div.innerHTML = `
          <div class="time">${formatLocalTime(f.date)}</div>
          <div class="teams">
            <div class="team">
              <img src="${home.logo}" alt="${home.name}" />
              <span>${home.name}</span>
            </div>
            <div class="score">${g.home ?? '—'} : ${g.away ?? '—'}</div>
            <div class="team" style="justify-content:flex-end;">
              <span>${away.name}</span>
              <img src="${away.logo}" alt="${away.name}" />
            </div>
          </div>
          <div class="right">
            <div class="league">
              <img src="${league.logo}" alt="${league.name}" />
              ${league.name}
            </div>
            <div class="status">${f.status?.long ?? f.status?.short ?? '—'}</div>
            <div class="small">${f.venue?.name ?? ''} ${f.venue?.city ? '- ' + f.venue.city : ''}</div>
          </div>
        `;
        matchesEl.appendChild(div);
      });
    }

    async function load() {
      const date = todayISO();
      dateLabel.textContent = date;
      matchesEl.innerHTML = '';
      statusEl.textContent = 'Fetching…';
      const key = apiKeyInput.value.trim();
      if (!key) {
        statusEl.textContent = 'Please enter your API key.';
        return;
      }
      try {
        const data = await fetchMatches(date, key);
        renderMatches(data);
      } catch (err) {
        statusEl.textContent = 'Error: ' + err.message;
      }
    }

    refreshBtn.addEventListener('click', load);
    load();
  </script>
</body>
</html>
